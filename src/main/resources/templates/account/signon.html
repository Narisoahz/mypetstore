<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="StyleSheet" href="../css/jpetstore.css" type="text/css" media="screen"/>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
<header th:replace="common/top"></header>
<div id="Content">
    <div id="Catalog">
        <form action="/account/signon" method="post">
            <p>Please enter your username and password.</p>
            <p>
                用户名:    <input type="text" name="username"><br/>
                密码:      <input type="password" name="password">.<br>
                输入手机:  <input type="text" name="phone" id="phone"><br>
                短信验证码:<input type="text" name="msgcode" id="msgcode" maxlength="6">
                           <input type="button" value="获取验证码" id="validationCode" name="validationCode"><br>
            </p>
            <p th:if="${msg!=null}" th:text="${msg}"></p>
            <p th:if="${msg1!=null}" th:text="${msg1}"></p>
            <input type="submit" value="Login">

        </form>

        Need a user name and password?
        <a href="/account/newAccountForm">Register Now!</a>
    </div>
</div>
<footer th:replace="common/bottom"></footer>
<script type="text/javascript">
    $("#validationCode").click(function(){
        var phone = $("#phone").val();
        if($("#phone").val() && $("#phone").val().length == 11){
            $.ajax({
                cache : false,
                url : "/account/sendSms",
                data : {phone : phone}
            });
            updateButtonStatus();
        }else {
            alert("请输入合法的手机号");
        }
    });

    var countdown=60;
    function updateButtonStatus(){
        var phone = $("#validationCode");
        if (countdown == 0) {
            phone.attr("disabled","false");
            phone.val("免费获取验证码");
            countdown = 60;
            return;
        } else {
            phone.attr("disabled","true");
            phone.val("重新发送(" + countdown + ")");
            countdown--;
        }
        setTimeout(function() {
                updateButtonStatus() }
            ,1000)
    }
</script>
</body>
</html>